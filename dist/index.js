var H=Object.create;var y=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var R=Object.getPrototypeOf,A=Object.prototype.hasOwnProperty;var k=(r,t)=>{for(var e in t)y(r,e,{get:t[e],enumerable:!0})},C=(r,t,e,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of M(t))!A.call(r,o)&&o!==e&&y(r,o,{get:()=>t[o],enumerable:!(a=F(t,o))||a.enumerable});return r};var I=(r,t,e)=>(e=r!=null?H(R(r)):{},C(t||!r||!r.__esModule?y(e,"default",{value:r,enumerable:!0}):e,r)),J=r=>C(y({},"__esModule",{value:!0}),r);var L={};k(L,{axiosInstance:()=>l,createSearchQuery:()=>$,default:()=>B,generateSearchFilter:()=>Q,generateSort:()=>O,handleFilter:()=>x,handleJoin:()=>m,handlePagination:()=>w,handleSort:()=>E,mapOperator:()=>g,transformErrorMessages:()=>S,transformHttpError:()=>d});module.exports=J(L);var g=r=>{switch(r){case"and":return"AND";case"or":return"OR";case"eq":case"ne":case"lt":case"gt":case"lte":case"gte":case"in":case"nin":case"contains":case"ncontains":return"notIn";case"containss":case"ncontainss":case"null":case"nnull":case"startswith":case"startswiths":case"endswith":case"endswiths":default:return""}};var Q=r=>$({operator:"and",value:r}),$=r=>{if(r.operator!=="and"&&r.operator!=="or"&&"field"in r)return r.operator==="eq"?{[r.field]:r.value}:{[r.field]:{[g(r.operator)]:r.value}};let{operator:t}=r;return{[g(t)]:r.value.map(e=>$(e))}},x=(r,t)=>(t&&r&&(r.where=Q(t)),r);var m=(r,t)=>r;var w=(r,t)=>{let{current:e=1,pageSize:a=10,mode:o="server"}=t??{};return o==="server"&&(r.pageSize=a,r.page=e),r};var O=r=>{if(r&&r.length>0){let t=[];return r.map(({field:e,order:a})=>{e&&a&&t.push({field:e,order:a.toUpperCase()})}),t}},E=(r,t)=>{let e=O(t);return r};var P=I(require("axios")),l=P.default.create();l.interceptors.response.use(r=>r,r=>{let t={...r,message:r.response?.data?.message,statusCode:r.response?.status};return Promise.reject(t)});var S=r=>{let t={};for(let e of r){let a=e.indexOf(" "),o=e.substring(0,a);t[o]?t[o].push(e):t[o]=[e]}return t};var d=r=>{let t=r.response.data.error,e=r.response.data.statusCode,a=r.response.data.message,o=S(a);return{statusCode:e,message:t,errors:o}};var b=require("query-string"),v=(r,t=l)=>({getList:async({resource:e,pagination:a,filters:o,sorters:s,meta:n})=>{let u=`${r}/${e}`,c={};c=w(c,a),c=x(c,o);let{data:i}=await t.get(`${u}?${new URLSearchParams({crudQuery:JSON.stringify(c)})}`);return Array.isArray(i)?{data:i,total:i.length}:{data:i.data,total:i.totalRecords}},getMany:async({resource:e,ids:a,meta:o})=>{let s=`${r}/${e}`,n={};n=m(n,o?.join);let{data:u}=await t.get(`${s}?${new URLSearchParams({crudQuery:JSON.stringify(n)})}`);return{data:u}},create:async({resource:e,variables:a})=>{let o=`${r}/${e}`;try{let{data:s}=await t.post(o,a);return{data:s}}catch(s){throw d(s)}},update:async({resource:e,id:a,variables:o})=>{let s=`${r}/${e}/${a}`;try{let{data:n}=await t.patch(s,o);return{data:n}}catch(n){throw d(n)}},updateMany:async({resource:e,ids:a,variables:o})=>{let s=[],n=await Promise.all(a.map(async u=>{try{let{data:c}=await t.patch(`${r}/${e}/${u}`,o);return c}catch(c){let i=d(c);s.push(i)}}));if(s.length>0)throw s;return{data:n}},createMany:async({resource:e,variables:a})=>{let o=`${r}/${e}/bulk`;try{let{data:s}=await t.post(o,{bulk:a});return{data:s}}catch(s){throw d(s)}},getOne:async({resource:e,id:a,meta:o})=>{let s=`${r}/${e}/${a}`,n={};n=m(n,o?.join);let{data:u}=await t.get(`${s}?${new URLSearchParams({crudQuery:JSON.stringify(n)})}`);return{data:u}},deleteOne:async({resource:e,id:a})=>{let o=`${r}/${e}/${a}`,{data:s}=await t.delete(o);return{data:s}},deleteMany:async({resource:e,ids:a})=>({data:await Promise.all(a.map(async s=>{let{data:n}=await t.delete(`${r}/${e}/${s}`);return n}))}),getApiUrl:()=>r,custom:async({url:e,method:a,meta:o,filters:s,sorters:n,payload:u,query:c,headers:i})=>{let p={};p=m(p,o?.join),p=E(p,n);let h=`${e}?${new URLSearchParams({crudQuery:JSON.stringify(p)})}`;c&&(h=`${h}&${(0,b.stringify)(c)}`);let f;switch(a){case"put":case"post":case"patch":f=await t[a](e,u,{headers:i});break;case"delete":f=await t.delete(e,{data:u,headers:i});break;default:f=await t.get(h,{headers:i});break}let{data:j}=f;return Promise.resolve({data:j})}});var B=v;
//# sourceMappingURL=index.js.map