(()=>{var v=Object.create;var h=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,M=Object.prototype.hasOwnProperty;var $=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(t,e)=>(typeof require<"u"?require:t)[e]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var R=(r,t,e,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of H(t))!M.call(r,o)&&o!==e&&h(r,o,{get:()=>t[o],enumerable:!(a=j(t,o))||a.enumerable});return r};var A=(r,t,e)=>(e=r!=null?v(F(r)):{},R(t||!r||!r.__esModule?h(e,"default",{value:r,enumerable:!0}):e,r));var g=r=>{switch(r){case"and":return"AND";case"or":return"OR";case"eq":case"ne":case"lt":case"gt":case"lte":case"gte":case"in":case"nin":case"contains":case"ncontains":return"notIn";case"containss":case"ncontainss":case"null":case"nnull":case"startswith":case"startswiths":case"endswith":case"endswiths":default:return""}};var k=r=>x({operator:"and",value:r}),x=r=>{if(r.operator!=="and"&&r.operator!=="or"&&"field"in r)return r.operator==="eq"?{[r.field]:r.value}:{[r.field]:{[g(r.operator)]:r.value}};let{operator:t}=r;return{[g(t)]:r.value.map(e=>x(e))}},w=(r,t)=>(t&&r&&(r.where=k(t)),r);var f=(r,t)=>r;var E=(r,t)=>{let{current:e=1,pageSize:a=10,mode:o="server"}=t??{};return o==="server"&&(r.pageSize=a,r.page=e),r};var I=r=>{if(r&&r.length>0){let t=[];return r.map(({field:e,order:a})=>{e&&a&&t.push({field:e,order:a.toUpperCase()})}),t}},S=(r,t)=>{let e=I(t);return r};var C=A($("axios")),l=C.default.create();l.interceptors.response.use(r=>r,r=>{let t={...r,message:r.response?.data?.message,statusCode:r.response?.status};return Promise.reject(t)});var Q=r=>{let t={};for(let e of r){let a=e.indexOf(" "),o=e.substring(0,a);t[o]?t[o].push(e):t[o]=[e]}return t};var p=r=>{let t=r.response.data.error,e=r.response.data.statusCode,a=r.response.data.message,o=Q(a);return{statusCode:e,message:t,errors:o}};var O=$("query-string"),P=(r,t=l)=>({getList:async({resource:e,pagination:a,filters:o,sorters:s,meta:n})=>{let u=`${r}/${e}`,c={};c=E(c,a),c=w(c,o);let{data:i}=await t.get(`${u}?${new URLSearchParams({crudQuery:JSON.stringify(c)})}`);return Array.isArray(i)?{data:i,total:i.length}:{data:i.data,total:i.totalRecords}},getMany:async({resource:e,ids:a,meta:o})=>{let s=`${r}/${e}`,n={};n=f(n,o?.join);let{data:u}=await t.get(`${s}?${new URLSearchParams({crudQuery:JSON.stringify(n)})}`);return{data:u}},create:async({resource:e,variables:a})=>{let o=`${r}/${e}`;try{let{data:s}=await t.post(o,a);return{data:s}}catch(s){throw p(s)}},update:async({resource:e,id:a,variables:o})=>{let s=`${r}/${e}/${a}`;try{let{data:n}=await t.patch(s,o);return{data:n}}catch(n){throw p(n)}},updateMany:async({resource:e,ids:a,variables:o})=>{let s=[],n=await Promise.all(a.map(async u=>{try{let{data:c}=await t.patch(`${r}/${e}/${u}`,o);return c}catch(c){let i=p(c);s.push(i)}}));if(s.length>0)throw s;return{data:n}},createMany:async({resource:e,variables:a})=>{let o=`${r}/${e}/bulk`;try{let{data:s}=await t.post(o,{bulk:a});return{data:s}}catch(s){throw p(s)}},getOne:async({resource:e,id:a,meta:o})=>{let s=`${r}/${e}/${a}`,n={};n=f(n,o?.join);let{data:u}=await t.get(`${s}?${new URLSearchParams({crudQuery:JSON.stringify(n)})}`);return{data:u}},deleteOne:async({resource:e,id:a})=>{let o=`${r}/${e}/${a}`,{data:s}=await t.delete(o);return{data:s}},deleteMany:async({resource:e,ids:a})=>({data:await Promise.all(a.map(async s=>{let{data:n}=await t.delete(`${r}/${e}/${s}`);return n}))}),getApiUrl:()=>r,custom:async({url:e,method:a,meta:o,filters:s,sorters:n,payload:u,query:c,headers:i})=>{let d={};d=f(d,o?.join),d=S(d,n);let y=`${e}?${new URLSearchParams({crudQuery:JSON.stringify(d)})}`;c&&(y=`${y}&${(0,O.stringify)(c)}`);let m;switch(a){case"put":case"post":case"patch":m=await t[a](e,u,{headers:i});break;case"delete":m=await t.delete(e,{data:u,headers:i});break;default:m=await t.get(y,{headers:i});break}let{data:b}=m;return Promise.resolve({data:b})}});var nr=P;})();
//# sourceMappingURL=index.js.map